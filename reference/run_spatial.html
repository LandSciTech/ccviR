<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run the spatial analysis — run_spatial • ccviR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run the spatial analysis — run_spatial"><meta property="og:description" content="Run the required spatial analysis to create the spat_df input for
calc_vulnerability and clip the range polygon to the
appropriate scales."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ccviR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/app_vignette.html">Using the ccviR app</a>
    </li>
    <li>
      <a href="../articles/package_vignette.html">Using the ccviR package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/see24/ccviR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run the spatial analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/see24/ccviR/blob/HEAD/R/run_spatial.R" class="external-link"><code>R/run_spatial.R</code></a></small>
    <div class="hidden name"><code>run_spatial.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Run the required spatial analysis to create the <code>spat_df</code> input for
<code><a href="calc_vulnerability.html">calc_vulnerability</a></code> and clip the range polygon to the
appropriate scales.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">run_spatial</span><span class="op">(</span>
  <span class="va">range_poly</span>,
  <span class="va">scale_poly</span>,
  <span class="va">clim_vars_lst</span>,
  non_breed_poly <span class="op">=</span> <span class="cn">NULL</span>,
  ptn_poly <span class="op">=</span> <span class="cn">NULL</span>,
  hs_rast <span class="op">=</span> <span class="cn">NULL</span>,
  hs_rcl <span class="op">=</span> <span class="cn">NULL</span>,
  gain_mod <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>range_poly</dt>
<dd><p>an sf polygon object giving the species range.</p></dd>
<dt>scale_poly</dt>
<dd><p>an sf polygon object giving the area of the assessment</p></dd>
<dt>clim_vars_lst</dt>
<dd><p>a list of climate data, the result of
<code><a href="get_clim_vars.html">get_clim_vars</a></code></p></dd>
<dt>non_breed_poly</dt>
<dd><p>Optional. An sf polygon object giving the species range
in the non-breeding season.</p></dd>
<dt>ptn_poly</dt>
<dd><p>Optional. An sf polygon object giving the locations that are
considered part of the physiological thermal niche (See NatureServe
Guidelines for definition).</p></dd>
<dt>hs_rast</dt>
<dd><p>Optional. A raster with results from a model of the change in
habitat suitability caused by climate change.</p></dd>
<dt>hs_rcl</dt>
<dd><p>a matrix used to classify <code>hs_rast</code> into 0: not suitable, 1:
lost, 2: maintained, 3: gained. See <code><a href="https://rdrr.io/pkg/raster/man/reclassify.html" class="external-link">reclassify</a></code> for
details on the matrix format</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a list with elements: <code>spat_table</code> the results of the spatial
  analysis, <code>range_poly_assess</code> the range polygon clipped to the
  assessment area, and <code>range_poly_clim</code> the range polygon clipped to
  the extent of the climate data.
<code>spat_table</code> contains the following columns:</p><dl><dt>MAT_#</dt>
<dd><p>The percentage of the species' range that is exposed to each class of change in mean annual temperature between the historical normal and predicted climate. Class 1 has the highest exposure and Class 6 the lowest</p></dd>

    <dt>CMD_#</dt>
<dd><p>The percentage of the species' range that is exposed to each class of change in climate moisture deficit between the historical normal and predicted climate. Class 1 has the highest exposure and Class 6 the lowest</p></dd>

    <dt>CCEI_#</dt>
<dd><p>The percentage of the species' non-breeding range that falls into each climate change exposure index class. Class 4 indicates high exposure while Class 1 indicates low exposure</p></dd>

    <dt>perc_non_breed_not_over_ccei</dt>
<dd><p>The precentage of the non-breeding range that does not overlap with the CCEI raster data</p></dd>

    <dt>HTN_#</dt>
<dd><p>The percentage of the species' range that is exposed to each class of variation between the historical coldest and warmest monts. Class 1 has the smallest variation and Class 4 is the largest</p></dd>

    <dt>PTN</dt>
<dd><p>The percentage of the species' range that falls into cool or cold environments that may be lost or reduced in the assessment area as a result of climate change</p></dd>

    <dt>MAP_max/min</dt>
<dd><p>The maximum and minimum historical mean annual precipitation in the species' range</p></dd>

    <dt>range_change</dt>
<dd><p>The projected decrease in range size as a percentage of current range size. Negative numbers indicate an increase in range size</p></dd>

    <dt>range_overlap</dt>
<dd><p>The percentage of the current range that is projected to remain in the future range.</p></dd>

    <dt>range_size</dt>
<dd><p>The area of the species' range in m2</p></dd>

    
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The range polygon will be clipped to the area overlapping the
<code>scale_poly</code> and also to the area overlapping the extent of the
climate data polygon. The range within the assessment area is used to
calculate all results except the historical thermal and hydrological niches
for which the range within the extent of the climate data is used.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="va">base_pth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"ccviR"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">clim_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_clim_vars.html">get_clim_vars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_pth</span>, <span class="st">"clim_files/processed"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">run_spatial</span><span class="op">(</span></span>
<span class="r-in">  range_poly <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_pth</span>, <span class="st">"rng_poly_high.shp"</span><span class="op">)</span>, agr <span class="op">=</span> <span class="st">"constant"</span><span class="op">)</span>,</span>
<span class="r-in">  scale_poly <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_pth</span>, <span class="st">"assess_poly.shp"</span><span class="op">)</span>, agr <span class="op">=</span> <span class="st">"constant"</span><span class="op">)</span>,</span>
<span class="r-in">  clim_vars_lst <span class="op">=</span> <span class="va">clim_vars</span>,</span>
<span class="r-in">  hs_rast <span class="op">=</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">base_pth</span>, <span class="st">"HS_rast_high.tif"</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">  hs_rcl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">7</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span> ,<span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> performing spatial analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $spat_table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 27</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MAT_1 MAT_2 MAT_3 MAT_4 MAT_5 MAT_6 CMD_1 CMD_2 CMD_3 CMD_4 CMD_5 CMD_6 CCEI_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>    10    90     0     0     0     0    10    90     0     0     0     0     <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 14 more variables: CCEI_2 &lt;dbl&gt;, CCEI_3 &lt;dbl&gt;, CCEI_4 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   perc_non_breed_not_over_ccei &lt;dbl&gt;, HTN_1 &lt;dbl&gt;, HTN_2 &lt;dbl&gt;, HTN_3 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   HTN_4 &lt;dbl&gt;, PTN &lt;dbl&gt;, MAP_max &lt;dbl&gt;, MAP_min &lt;dbl&gt;, range_change &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   range_overlap &lt;dbl&gt;, range_size &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $range_poly_assess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 1 feature and 2 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Attribute-geometry relationship: 2 constant, 0 aggregate, 0 identity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 0 ymin: 750 xmax: 1000 ymax: 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: NAD83(CSRS) / Ontario MNR Lambert</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     FID FID.1                                      geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                                 <span style="color: #949494; font-style: italic;">&lt;POLYGON [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     0     0 ((0 750, 0 1000, 1000 1000, 1000 750, 0 750))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $range_poly_clim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 1 feature and 2 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Attribute-geometry relationship: 2 constant, 0 aggregate, 0 identity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 0 ymin: 750 xmax: 1000 ymax: 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: NAD83(CSRS) / Ontario MNR Lambert</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     FID FID.1                                      geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                                 <span style="color: #949494; font-style: italic;">&lt;POLYGON [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     0     0 ((0 750, 0 1000, 1000 1000, 1000 750, 0 750))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sarah Endicott.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

